!function(){"use strict";var e=e=>new Promise(((t,r)=>{const n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e.url),e.integrity&&n.setAttribute("integrity",e.integrity),e.async&&n.setAttribute("async",e.async.toString()),e.defer&&n.setAttribute("defer",e.defer.toString()),e.crossOrigin&&n.setAttribute("crossorigin",e.crossOrigin),n.onload=t,n.onerror=r,document.head.appendChild(n)}));var t=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();var r=e=>{try{return JSON.parse(e),!0}catch(e){return!1}};var n=e=>window.webkit&&window.webkit.messageHandlers&&e.ios in window.webkit.messageHandlers&&"function"==typeof window.webkit.messageHandlers[e.ios].postMessage?"ios":e.android in window?"android":"";var a=e=>"object"===t(e)?{...e}:"array"===t(e)?[...e]:e;const i=(e,r)=>{if("object"!==t(e))return e;const n={},a=Object.keys(e),s=Object.keys(r);for(let o=0,c=a.length;o<c;o+=1){const c=a[o],u=e[c],l=s.indexOf(c)>-1?r[c]:c;if("object"===t(u))n[l]=i({...u},r);else if("array"===t(u)){n[l]=[...u];for(let e=0,t=u.length;e<t;e+=1)n[l][e]=i(u[e],r)}else n[l]=u}return n};var s=i,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var c=function(e,t){return e===t||e!=e&&t!=t},u="object"==typeof o&&o&&o.Object===Object&&o,l=u,d="object"==typeof self&&self&&self.Object===Object&&self,h=l||d||Function("return this")(),f=h.Symbol,m=f,p=Object.prototype,E=p.hasOwnProperty,v=p.toString,g=m?m.toStringTag:void 0;var _=function(e){var t=E.call(e,g),r=e[g];try{e[g]=void 0;var n=!0}catch(e){}var a=v.call(e);return n&&(t?e[g]=r:delete e[g]),a},y=Object.prototype.toString;var O=_,S=function(e){return y.call(e)},b=f?f.toStringTag:void 0;var T=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":b&&b in Object(e)?O(e):S(e)};var A=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},I=T,N=A;var R=function(e){if(!N(e))return!1;var t=I(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var w=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},C=R,D=w;var M=function(e){return null!=e&&D(e.length)&&!C(e)},L=/^(?:0|[1-9]\d*)$/;var j=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&L.test(e))&&e>-1&&e%1==0&&e<t};var P=function(e){return null!=e&&"object"==typeof e};let U="~";function V(){}Object.create&&(V.prototype=Object.create(null),(new V).__proto__||(U=!1));class F{constructor(e,t,r=!1){this.handler=e,this.context=t,this.once=r}}function x(e,t,r,n,a){if("function"!=typeof r)throw new TypeError("The handler must be a function.");if("symbol"==typeof t&&e._prefix)throw new TypeError("The event name cannot be a symbol when events should be prefixed. Use string literals instead.");const i=new F(r,n||e,a),s=e._prefix?`${e._prefix}${t}`:t;return e._listeners[s]||(e._listeners[s]=[],e._listenerCount+=1),e._listeners[s].push(i),e}function G(e,t){const r=e._prefix?`${e._prefix}${t}`:t;0==--e._listenerCount?e._listeners=new V:delete e._listeners[r]}function q(e,t,...r){e.parent&&e.parent instanceof k&&e.parent.emit(t,...r)}class k{get eventNames(){let e=[];return 0===this._listenerCount||(e=e.concat(Object.keys(this._listeners).map((e=>this._prefix?e.slice(1):e))),Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(this._listeners)))),e}get parent(){return this._parent}set parent(e){this._parent=e}constructor(){this._prefix=U,this._listeners=new V,this._listenerCount=0,this._parent=void 0}has(e){if("symbol"==typeof e)return Object.getOwnPropertySymbols(this._listeners).includes(e);const t=this._prefix?`${this._prefix}${e}`:e;return Object.keys(this._listeners).includes(t)}on(e,t,r){return x(this,e,t,r)}once(e,t,r){return x(this,e,t,r,!0)}off(e,t,r,n=!1){const a=this._prefix?`${this._prefix}${e}`:e;if(!this.has(e))return this;const i=this._listeners[a];if(!t||i.length<=1)return G(this,a),this;const s=i.findIndex((e=>e.handler===t&&e.context===(r||this)&&e.once===n));return s>-1&&i.splice(s,1),this}clear(e){const t=this._prefix?`${this._prefix}${e}`:e;return this.has(e)?G(this,t):(this._listeners=new V,this._listenerCount=0),this}emit(e,...t){const r=this._prefix?`${this._prefix}${e}`:e;if(this.has(e)||this.has(k.EVENT_CONFIG.ALL_EVENTS_KEY)){let n=this._listeners[r];if(this.has(k.EVENT_CONFIG.ALL_EVENTS_KEY)){const e=this._listeners[k.EVENT_CONFIG.ALL_EVENTS_KEY];n=[...n=n||[],...e]}for(let e=n.length;e>=0;e-=1){const a=n[e];if(a){const{handler:e,once:n,context:i}=a;n&&this.off(r,e,i,n),e.call(i,...t)}}return q(this,e,...t),!0}return q(this,e,...t),!1}all(e,t){return x(this,k.EVENT_CONFIG.ALL_EVENTS_KEY,e,t)}none(e,t){return this.off(k.EVENT_CONFIG.ALL_EVENTS_KEY,e,t)}}k.EVENT_CONFIG={ALL_EVENTS_KEY:"~ALL_EVENTS~"};var $=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a},z=$;var B,Y=function(e,t){return z(t,(function(t){return[t,e[t]]}))},Q=h["__core-js_shared__"],H=(B=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"";var J=function(e){return!!H&&H in e},X=Function.prototype.toString;var W=function(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""},K=R,Z=J,ee=A,te=W,re=/^\[object .+?Constructor\]$/,ne=Function.prototype,ae=Object.prototype,ie=ne.toString,se=ae.hasOwnProperty,oe=RegExp("^"+ie.call(se).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ce=function(e,t){return null==e?void 0:e[t]},ue=function(e){return!(!ee(e)||Z(e))&&(K(e)?oe:re).test(te(e))},le=ce;var de=function(e,t){var r=le(e,t);return ue(r)?r:void 0},he=de(h,"DataView"),fe=de(h,"Map"),me=he,pe=fe,Ee=de(h,"Promise"),ve=de(h,"Set"),ge=de(h,"WeakMap"),_e=T,ye=W,Oe="[object Map]",Se="[object Promise]",be="[object Set]",Te="[object WeakMap]",Ae="[object DataView]",Ie=ye(me),Ne=ye(pe),Re=ye(Ee),we=ye(ve),Ce=ye(ge),De=_e;(me&&De(new me(new ArrayBuffer(1)))!=Ae||pe&&De(new pe)!=Oe||Ee&&De(Ee.resolve())!=Se||ve&&De(new ve)!=be||ge&&De(new ge)!=Te)&&(De=function(e){var t=_e(e),r="[object Object]"==t?e.constructor:void 0,n=r?ye(r):"";if(n)switch(n){case Ie:return Ae;case Ne:return Oe;case Re:return Se;case we:return be;case Ce:return Te}return t});var Me=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var Le=Y,je=De,Pe=Me,Ue=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r};var Ve=function(e){return function(t){var r=je(t);return"[object Map]"==r?Pe(t):"[object Set]"==r?Ue(t):Le(t,e(t))}};var Fe=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},xe=T,Ge=P;var qe=function(e){return Ge(e)&&"[object Arguments]"==xe(e)},ke=P,$e=Object.prototype,ze=$e.hasOwnProperty,Be=$e.propertyIsEnumerable,Ye=qe(function(){return arguments}())?qe:function(e){return ke(e)&&ze.call(e,"callee")&&!Be.call(e,"callee")},Qe=Ye,He=Array.isArray,Je={exports:{}};var Xe=function(){return!1};!function(e,t){var r=h,n=Xe,a=t&&!t.nodeType&&t,i=a&&e&&!e.nodeType&&e,s=i&&i.exports===a?r.Buffer:void 0,o=(s?s.isBuffer:void 0)||n;e.exports=o}(Je,Je.exports);var We=T,Ke=w,Ze=P,et={};et["[object Float32Array]"]=et["[object Float64Array]"]=et["[object Int8Array]"]=et["[object Int16Array]"]=et["[object Int32Array]"]=et["[object Uint8Array]"]=et["[object Uint8ClampedArray]"]=et["[object Uint16Array]"]=et["[object Uint32Array]"]=!0,et["[object Arguments]"]=et["[object Array]"]=et["[object ArrayBuffer]"]=et["[object Boolean]"]=et["[object DataView]"]=et["[object Date]"]=et["[object Error]"]=et["[object Function]"]=et["[object Map]"]=et["[object Number]"]=et["[object Object]"]=et["[object RegExp]"]=et["[object Set]"]=et["[object String]"]=et["[object WeakMap]"]=!1;var tt=function(e){return Ze(e)&&Ke(e.length)&&!!et[We(e)]};var rt=function(e){return function(t){return e(t)}},nt={exports:{}};!function(e,t){var r=u,n=t&&!t.nodeType&&t,a=n&&e&&!e.nodeType&&e,i=a&&a.exports===n&&r.process,s=function(){try{var e=a&&a.require&&a.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=s}(nt,nt.exports);var at=tt,it=rt,st=nt.exports,ot=st&&st.isTypedArray,ct=ot?it(ot):at,ut=Fe,lt=Qe,dt=He,ht=Je.exports,ft=j,mt=ct,pt=Object.prototype.hasOwnProperty;var Et=function(e,t){var r=dt(e),n=!r&&lt(e),a=!r&&!n&&ht(e),i=!r&&!n&&!a&&mt(e),s=r||n||a||i,o=s?ut(e.length,String):[],c=o.length;for(var u in e)!t&&!pt.call(e,u)||s&&("length"==u||a&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ft(u,c))||o.push(u);return o},vt=Object.prototype;var gt=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||vt)};var _t=function(e,t){return function(r){return e(t(r))}},yt=_t(Object.keys,Object),Ot=gt,St=yt,bt=Object.prototype.hasOwnProperty;var Tt=function(e){if(!Ot(e))return St(e);var t=[];for(var r in Object(e))bt.call(e,r)&&"constructor"!=r&&t.push(r);return t},At=Et,It=Tt,Nt=M;var Rt=function(e){return Nt(e)?At(e):It(e)},wt=Ve(Rt),Ct=wt,Dt=$;var Mt=function(e,t){return Dt(t,(function(t){return e[t]}))},Lt=Mt,jt=Rt;var Pt=function(e){return null==e?[]:Lt(e,jt(e))};const Ut=(e,t,r,n={})=>{const a=["namespace","module","method","message"][t],i=r[e[a]-1];return i&&(n[a]=i.text,i.children&&i.children.length)?Ut(e,t+1,i.children,n):n};class Vt{get level(){return Object.keys(Vt.TYPES)[this.type-1].toLowerCase()}get plainData(){return{createdAt:new Date(this.createdAt).toJSON(),level:this.level,namespace:this.namespace,module:this.module,method:this.method,message:this.message,internalMessage:this.internalMessage}}constructor(e,t,r,n,a,i){this.type=e,this.namespace=t,this.module=r,this.method=n,this.message=a,this.internalMessage=i,this.createdAt=Date.now()}includes(e){return!!this.internalMessage&&this.internalMessage.includes(e)}toJSON(e=!1){const{plainData:t}=this;return JSON.stringify(e?s(t,Vt.SHORTNAME_MAPPING):t)}prettify(e,t,r={abbreviate:!1,prefix:void 0,delimiter:" | "}){if(!0===Pt(Vt.FORMATS).includes(e)){const{plainData:n}=this,a={...n,...Ut(n,0,t)};if(e===Vt.FORMATS.JSON)return JSON.stringify(r.abbreviate?s(a,Vt.SHORTNAME_MAPPING):a);let i=[];return i=i.concat(Ct(a).map((([e,t])=>`${e.toUpperCase()}:${t}`))),r.prefix&&i.push(r.prefix),i.reverse().join(r.delimiter)}return""}}Vt.TYPES=Object.defineProperties({},{INFO:{value:1,enumerable:!0},WARNING:{value:2,enumerable:!0},ERROR:{value:3,enumerable:!0},FATAL:{value:4,enumerable:!0}}),Vt.FORMATS=Object.defineProperties({},{JSON:{value:1,enumerable:!0},LOG:{value:2,enumerable:!0}}),Vt.fromJSON=e=>{const t=JSON.parse(e);if(t.level&&void 0===t.type){const[,e]=Ct(Vt.TYPES).find((([e])=>e.toLowerCase()===t.level));t.type=e}const{type:r,namespace:n,module:a,method:i,message:s,internalMessage:o}=t;return new Vt(r,n,a,i,s,o)},Vt.SHORTNAME_MAPPING={level:"lv",type:"tp",namespace:"ns",module:"md",method:"mt",message:"ms",internalMessage:"im",createdAt:"ca"};var Ft=Vt;class xt{get size(){return this.items.length}constructor(e){this.items=[];for(let t=0,r=e.length;t<r;t+=1)this.enqueue(e[t])}enqueue(e){this.items.push(e)}dequeue(){return this.items.shift()}flush(){this.items=[]}}const Gt=(e,t)=>{try{const{options:n}=e;e.pending=!0;const a=Array.from(t),i=a.slice(1,a.length),s=a[0];let o,c=((e,t)=>{const{options:r,facades:n}=e;if(r.multiTenancy){const e="number"==typeof t[0]?t[0]:r.defaultTenant;return n.get(e)}return n.get(0)})(e,i);c||(c=((e,t)=>{const{facadeFactory:r,options:n}=e,a=r(e);if(n.multiTenancy){const r="number"==typeof t[0]?t[0]:n.defaultTenant;e.facades.set(r,a)}else e.facades.set(0,a);return a})(e,i)),o=!0===n.multiTenancy&&"number"==typeof i[0]?i.slice(1,i.length):i;const u=c[s](...o);!0===(r=u,Boolean(r&&"function"==typeof r.then))?u.then((t=>e.emit("executed",t))).catch((t=>e.emit("error",t))):e.emit("executed",s,u)}catch(t){e.emit("error",t)}var r};class qt extends k{constructor(e,t={},r=[]){super(),this.pending=!1,this.failed=!1,this.queue=new xt(r),this.facades=new Map,this.facadeFactory=e,this.options={mode:1,multiTenancy:!1,continueOnError:!0,logging:!1,defaultTenant:1,onError:void 0,onExecuted:void 0,...t},this.on("executed",(e=>((e,t)=>{const{options:r}=e;r.onExecuted&&"function"==typeof r.onExecuted&&r.onExecuted(t),e.pending=!1,e.failed=!1,r.mode===qt.MODE.AUTO&&e.dequeue()})(this,e))),this.on("error",(e=>((e,t)=>{const{options:r}=e;r.logging&&console.error(t),r.onError&&"function"==typeof r.onError&&r.onError(t),e.pending=!1,e.failed=!0,!0===r.continueOnError&&r.mode===qt.MODE.AUTO&&e.dequeue()})(this,e))),this.queue.size>0&&this.options.mode===qt.MODE.AUTO&&this.dequeue()}flush(){this.queue.flush()}addFacadeFactory(e){this.facadeFactory=e,this.queue.size>0&&this.options.mode===qt.MODE.AUTO&&this.dequeue()}removeFacadeFactory(){this.facadeFactory=void 0,this.facades.clear()}dequeue(){if(!0===this.pending)setTimeout((()=>this.dequeue()),10);else{if(this.queue.size>0&&(!1===this.failed||!0===this.options.continueOnError)&&this.facadeFactory&&"function"==typeof this.facadeFactory){const e=this.queue.dequeue();Gt(this,e)}}}enqueue(...e){1===e.length&&"string"!=typeof e[0]?this.queue.enqueue(e[0]):this.queue.enqueue(e),this.options.mode===qt.MODE.AUTO&&this.dequeue()}push(...e){this.enqueue(...e)}}qt.MODE=Object.defineProperties({},{AUTO:{value:1,enumerable:!0},MANUAL:{value:2,enumerable:!0}});var kt=wt;var $t=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function zt(e,t,r,n,a){return new Ft(e,t,r,n,a)}const Bt=(e,t)=>{const r=kt(e),n=[];for(let e=0,a=t.length;e<a;e+=1){const a=t[e],i=r.find((([e])=>e===a.name||e===a.abbreviation));let s;i&&(s=i[1]),n.push({...a,value:s})}return n};class Yt extends k{constructor(e){super(),this.moduleId=2,this.commands=e,this.parameters=void 0}parse(e,...t){const n=this.commands.find((t=>t.name===e||t.abbreviation===e));return n?(this.command=n,this.parameters=((e,t)=>{let n=[];const{parameters:a}=e;for(let o=0,c=a.length;o<c;o+=1){let c=a[o],u=t[o];if(r(u)&&e.options&&!0===e.options.allowJSON&&(u=JSON.parse(u)),"function"===$t(c)){const e=a[o](t);c=e&&1===e.length?e[0]:e}c&&(n="object"===$t(u)?n.concat(Bt(u,c)):n.concat((i=u,s=c,[{...s,value:i}])))}var i,s;return n})(n,t),this.emit(Yt.EVENTS.PARSING_SUCCEEDED,{command:n,parameters:this.parameters})):this.emit(Yt.EVENTS.PARSING_FAILED,zt(Ft.TYPES.ERROR,1,this.moduleId,1,1)),this}reset(){return this.command=void 0,this.parameters=void 0,this.emit(Yt.EVENTS.PARSING_RESET,zt(Ft.TYPES.INFO,1,this.moduleId,1,2)),this}}Yt.EVENTS={PARSING_FAILED:"PARSING_FAILED",PARSING_SUCCEEDED:"PARSING_SUCCEEDED",PARSING_RESET:"PARSING_RESET"};var Qt=Yt;const Ht={VALIDATION_ASSERTED:"VALIDATION_ASSERTED",VALIDATION_ABORTED:"VALIDATION_ABORTED",VALIDATION_FAILED:"VALIDATION_FAILED",VALIDATION_SUCCEEDED:"VALIDATION_SUCCEEDED",VALIDATION_RESET:"VALIDATION_RESET",VALIDATION_VALUE_MODIFIED:"VALIDATION_VALUE_MODIFIED"},Jt=e=>["requiredIf"].includes(e),Xt=(e,t)=>{const{rules:r,value:n}=e,a=[];for(let i=0,s=r.length;i<s;i+=1){const{name:s,assert:o}=r[i];if(Jt(s)){const r=t.find((t=>t.name===e.sibling));a.push({name:s,assertion:o(n,r.value)})}else a.push({name:s,assertion:o(n)})}return a},Wt=(e,t,r)=>{let n=!1;e.parameters[t].assertions=[];for(let a=0,i=r.length;a<i;a+=1){const{assertion:i,name:s}=r[a];if(e.parameters[t].assertions.push(i),n=i instanceof Ft&&i.type===Ft.TYPES.FATAL,!0===n)return{abort:n,assertion:i};if("array"===$t(i)){const[r,n,a]=i;e.parameters[t].value=r,e.emit(Ht.VALIDATION_VALUE_MODIFIED,{rule:s,modified:r,origin:n},a)}e.emit(Ht.VALIDATION_ASSERTED,s,zt(Ft.TYPES.INFO,1,e.moduleId,2,3))}return{abort:n}};class Kt extends Qt{constructor(e){super(e),this.moduleId=3,this.valid=!1,this.lastAssertion=void 0}validate(){return this.command&&this.parameters&&this.parameters.length>0?(this.valid=(e=>{for(let t=0,r=e.parameters.length;t<r;t+=1){const r=Xt(e.parameters[t],e.parameters),{abort:n,assertion:a}=Wt(e,t,r);if(e.lastAssertion=a,n)return e.emit(Ht.VALIDATION_ABORTED,a),!1}return!0})(this),!0===this.valid?this.emit(Kt.EVENTS.VALIDATION_SUCCEEDED,{command:this.command,parameters:this.parameters}):this.emit(Kt.EVENTS.VALIDATION_FAILED,zt(Ft.TYPES.FATAL,1,this.moduleId,2,2))):this.emit(Kt.EVENTS.VALIDATION_FAILED,zt(Ft.TYPES.ERROR,1,this.moduleId,2,1)),this}reset(){return this.valid=!1,super.reset(),this}}Kt.EVENTS={...Qt.EVENTS,...Ht};var Zt=Kt;class er extends Zt{constructor(e){super(e),this.moduleId=4,this.data=void 0}serialize(e=!1){return this.command&&this.parameters&&this.parameters.length>0&&(this.data=((e,t)=>{const r={};for(let n=0,a=e.length;n<a;n+=1)r[t?e[n].abbreviation:e[n].name]=e[n].value;return r})(this.parameters,e),this.emit(er.EVENTS.SERIALIZATION_SUCCEEDED,{command:this.command.name,parameters:this.data})),this}result(){return{command:this.command.name,parameters:this.data}}reset(){return this.data=void 0,super.reset()}}er.EVENTS={...Zt.EVENTS,SERIALIZATION_SUCCEEDED:"SERIALIZATION_SUCCEEDED"};var tr=er,rr=de(Object,"create"),nr=rr;var ar=function(){this.__data__=nr?nr(null):{},this.size=0};var ir=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},sr=rr,or=Object.prototype.hasOwnProperty;var cr=function(e){var t=this.__data__;if(sr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return or.call(t,e)?t[e]:void 0},ur=rr,lr=Object.prototype.hasOwnProperty;var dr=function(e){var t=this.__data__;return ur?void 0!==t[e]:lr.call(t,e)},hr=rr;var fr=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=hr&&void 0===t?"__lodash_hash_undefined__":t,this},mr=ar,pr=ir,Er=cr,vr=dr,gr=fr;function _r(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}_r.prototype.clear=mr,_r.prototype.delete=pr,_r.prototype.get=Er,_r.prototype.has=vr,_r.prototype.set=gr;var yr=_r;var Or=function(){this.__data__=[],this.size=0},Sr=c;var br=function(e,t){for(var r=e.length;r--;)if(Sr(e[r][0],t))return r;return-1},Tr=br,Ar=Array.prototype.splice;var Ir=function(e){var t=this.__data__,r=Tr(t,e);return!(r<0)&&(r==t.length-1?t.pop():Ar.call(t,r,1),--this.size,!0)},Nr=br;var Rr=function(e){var t=this.__data__,r=Nr(t,e);return r<0?void 0:t[r][1]},wr=br;var Cr=function(e){return wr(this.__data__,e)>-1},Dr=br;var Mr=function(e,t){var r=this.__data__,n=Dr(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Lr=Or,jr=Ir,Pr=Rr,Ur=Cr,Vr=Mr;function Fr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Fr.prototype.clear=Lr,Fr.prototype.delete=jr,Fr.prototype.get=Pr,Fr.prototype.has=Ur,Fr.prototype.set=Vr;var xr=yr,Gr=Fr,qr=fe;var kr=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},$r=kr;var zr=function(e,t){var r=e.__data__;return $r(t)?r["string"==typeof t?"string":"hash"]:r.map},Br=zr;var Yr=function(e){var t=Br(this,e).delete(e);return this.size-=t?1:0,t},Qr=zr;var Hr=function(e){return Qr(this,e).get(e)},Jr=zr;var Xr=function(e){return Jr(this,e).has(e)},Wr=zr;var Kr=function(e,t){var r=Wr(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Zr=function(){this.size=0,this.__data__={hash:new xr,map:new(qr||Gr),string:new xr}},en=Yr,tn=Hr,rn=Xr,nn=Kr;function an(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}an.prototype.clear=Zr,an.prototype.delete=en,an.prototype.get=tn,an.prototype.has=rn,an.prototype.set=nn;var sn=an,on=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},cn=function(e){return this.__data__.has(e)};function un(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new sn;++t<r;)this.add(e[t])}un.prototype.add=un.prototype.push=on,un.prototype.has=cn;var ln=function(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1};var dn=function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1},hn=ln,fn=function(e){return e!=e},mn=dn;var pn=function(e,t,r){return t==t?mn(e,t,r):hn(e,fn,r)};var En=function(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1};var vn=function(e,t){return e.has(t)},gn=un,_n=function(e,t){return!!(null==e?0:e.length)&&pn(e,t,0)>-1},yn=En,On=$,Sn=rt,bn=vn,Tn=Math.min;var An=function(e,t,r){for(var n=r?yn:_n,a=e[0].length,i=e.length,s=i,o=Array(i),c=1/0,u=[];s--;){var l=e[s];s&&t&&(l=On(l,Sn(t))),c=Tn(l.length,c),o[s]=!r&&(t||a>=120&&l.length>=120)?new gn(s&&l):void 0}l=e[0];var d=-1,h=o[0];e:for(;++d<a&&u.length<c;){var f=l[d],m=t?t(f):f;if(f=r||0!==f?f:0,!(h?bn(h,m):n(u,m,r))){for(s=i;--s;){var p=o[s];if(!(p?bn(p,m):n(e[s],m,r)))continue e}h&&h.push(m),u.push(f)}}return u};var In=function(e){return e};var Nn=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Rn=Nn,wn=Math.max;var Cn=function(e,t,r){return t=wn(void 0===t?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=wn(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(s),Rn(e,this,o)}};var Dn=function(e){return function(){return e}},Mn=de,Ln=function(){try{var e=Mn(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),jn=Dn,Pn=Ln,Un=Pn?function(e,t){return Pn(e,"toString",{configurable:!0,enumerable:!1,value:jn(t),writable:!0})}:In,Vn=Un,Fn=Date.now;var xn=function(e){var t=0,r=0;return function(){var n=Fn(),a=16-(n-r);if(r=n,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},Gn=xn(Vn),qn=In,kn=Cn,$n=Gn;var zn=function(e,t){return $n(kn(e,t,qn),e+"")},Bn=M,Yn=P;var Qn=function(e){return Yn(e)&&Bn(e)};var Hn=$,Jn=An,Xn=function(e){return Qn(e)?e:[]},Wn=zn((function(e){var t=Hn(e,Xn);return t.length&&t[0]===e[0]?Jn(t):[]}));var Kn=e=>"array"===$t(e)?!!e.length:null!=e&&!Number.isNaN(e)&&(!1===e||(e instanceof Date?!Number.isNaN(e.getTime()):"object"===$t(e)?!!Object.keys(e).length:!!String(e).length));var Zn=e=>t=>!Kn(t)||null!==t.toString().match(e);var ea=Zn(/^[a-zA-Z0-9]*$/);var ta=Zn(/[ -~]/);var ra=(e,t)=>r=>!Kn(r)||(!/\s/.test(r)||r instanceof Date)&&e<=+r&&t>=+r;var na=e=>"array"===$t(e)?e.length:"object"===$t(e)?Object.keys(e).length:String(e).length;var aa=e=>t=>!Kn(t)||na(t)<=e;var ia=e=>t=>!Kn(t)||na(t)>=e;var sa=Zn(/^\d*(\.\d+)?$/);var oa=e=>t=>!Kn(t)||e.indexOf(t)>-1;var ca=e=>t=>!Kn(t)||$t(t)===e;function ua(e,t){return(...r)=>e(...r)||t()}class la extends k{constructor(e,t,r={maxExecutionBeforeStop:3,fillParameters:!1}){super(),this.moduleId=4,this.history=new Map,this.stats={},this.data={},this.commandQueue=e,this.commandSerializer=new tr(t),this.options=r}process(e,...t){try{let r;const n=this.commandSerializer.commands.find((t=>t.name===e||t.abbreviation===e));if(n){const{abbreviation:a,name:i}=n;if(void 0===this.stats[a]&&(this.stats[a]=0),this.options.fillParameters&&!1===Kn(t)&&this.data[a])return r={command:i,parameters:this.data[a]},this.emit(la.EVENTS.PROCESSING_SUCCEEDED,r),r;const{valid:s,stop:o}=((e,t,r,n)=>{let a=!0,i=!1;if(e.dependencies&&e.dependencies.length>0){const s=Array.from(t.keys());a=Wn(s,e.dependencies).length===e.dependencies.length,i=r[e.abbreviation]>n}return{stop:i,valid:a}})(n,this.history,this.stats,this.options.maxExecutionBeforeStop);if(!0===s&&!1===o)if(this.commandSerializer.reset().parse(e,...t).validate(),this.commandSerializer.valid){r=this.commandSerializer.serialize().result();const e="function"==typeof n.id?n.id(r.parameters):n.id;this.history.set(e,{parameters:t,createdAt:Date.now()}),this.stats[a]=0,this.data[a]=r.parameters,this.emit(la.EVENTS.PROCESSING_SUCCEEDED,r)}else this.stats[a]+=1,this.emit(la.EVENTS.PROCESSING_FAILED,this.commandSerializer.lastAssertion);else!1===s&&!1===o?(this.stats[a]+=this.stats[a]+1,this.commandQueue.enqueue(e,...t),this.emit(la.EVENTS.PROCESSING_REQUEUED,new Ft(Ft.TYPES.WARNING,1,this.moduleId,1,1))):this.emit(la.EVENTS.PROCESSING_FAILED,new Ft(Ft.TYPES.FATAL,1,this.moduleId,1,2))}return r}catch(e){const t=new Ft(Ft.TYPES.FATAL,1,this.moduleId,1,3,e.message);return void this.emit(la.EVENTS.PROCESSING_FAILED,t)}}getCommandParameters(e){const t=this.commandSerializer.commands.find((t=>t.name===e||t.abbreviation===e));if(t)return this.data[t.abbreviation]}reset(){this.commandSerializer.reset(),this.stats={},this.history=new Map,this.data={}}}la.EVENTS={PROCESSING_SUCCEEDED:"PROCESSING_SUCCEEDED",PROCESSING_FAILED:"PROCESSING_FAILED",PROCESSING_REQUEUED:"PROCESSING_REQUEUED"};var da=la;var ha=e=>({name:"appSite",abbreviation:"as",sibling:"hybrid",rules:e});var fa=e=>({name:"code",abbreviation:"cp",rules:e});var ma=e=>({name:"comment",abbreviation:"co",rules:e});var pa=e=>({name:"consentString",abbreviation:"ct",rules:e});var Ea=e=>({name:"country",abbreviation:"cn",rules:e});var va=e=>({name:"debug",abbreviation:"dg",rules:e});var ga=e=>({name:"distributionChannel",abbreviation:"dc",rules:e});var _a=e=>({name:"domainServiceName",abbreviation:"dn",rules:e});var ya=e=>({name:"event",abbreviation:"ev",rules:e});var Oa=e=>({name:"hybrid",abbreviation:"hy",rules:e});var Sa=e=>({name:"hybridToken",abbreviation:"ht",rules:e});var ba=e=>({name:"mediaTypes",abbreviation:"mt",rules:e});var Ta=e=>({name:"methods",abbreviation:"mh",rules:e});var Aa=e=>({name:"mode",abbreviation:"mo",rules:e});var Ia=e=>({name:"multiIdentifier",abbreviation:"mi",rules:e});var Na=e=>({name:"pixelType",abbreviation:"pt",rules:e});var Ra=e=>({name:"site",abbreviation:"st",rules:e});var wa=e=>({name:"surveyType",abbreviation:"sv",rules:e});var Ca=e=>({name:"tenant",abbreviation:"ta",rules:e});var Da=e=>({name:"thirdPartyModule",abbreviation:"3p",rules:e});var Ma=(e,t,r)=>n=>e(n)||[t,n,zt(2,...r)];var La=(e,t)=>({name:e,assert:t});var ja=[La("required",Ma(Kn,void 0,[1,1,5,1])),La("typeOf",ua(ca("string"),(()=>zt(4,1,1,5,2)))),La("alphanumeric",ua(ea,(()=>zt(4,1,1,5,3)))),La("min",ua(ia(3),(()=>zt(4,1,1,5,4)))),La("max",ua(aa(15),(()=>zt(4,1,1,5,5))))];function Pa(e,t){return r=>Kn(r)||[e,r,zt(2,...t)]}var Ua=(e,t,r)=>n=>!Kn(n)||[n.replace(e,t),n,zt(2,...r)];var Va=(e,t)=>r=>{if(Kn(r)&&!1===aa(e)(r)){let n;return n="number"===$t(r)?((e,t)=>{let r=e.toString();return r=r.slice(0,t),parseInt(r,10)})(r,e):"array"===$t(r)||"string"===$t(r)?r.slice(0,e):"object"===$t(r)?((e,t)=>{const r=Object.keys(e),n={};for(let a=0,i=t;a<i;a+=1)n[r[a]]=e[r[a]];return n})(r,e):r,[n,r,zt(2,...t)]}return!0};const Fa="Leercode_nichtzuordnungsfaehig",xa=["qds","dcf","nid"];var Ga=[La("required",Ma(Kn,Fa,[1,1,6,1])),La("typeOf",Ma(ca("string"),Fa,[1,1,6,2])),La("sanitize",Ua(/[^a-zA-Z0-9,_/\-?#]/g,".",[1,1,6,3])),La("truncate",Va(256,[1,1,6,4]))];var qa=[La("defined",Ma(Kn,void 0,[1,1,7,1])),La("typeOf",Ma(ca("string"),void 0,[1,1,7,2])),La("ascii",Ma(ta,void 0,[1,1,7,3])),La("truncate",Va(256,[1,1,7,4]))];var ka=e=>Zn(new RegExp(`^([0-9a-fA-F]{2})([0-9a-fA-F]{${4*e}})$`,"g"));var $a=(e=!0)=>{const t=[La("required",ua(Kn,(()=>zt(4,1,1,8,1)))),La("typeOf",ua(ca("string"),(()=>zt(4,1,1,8,2)))),La("consentString",ua(ka(2),(()=>zt(4,1,1,8,3))))];return!1===e&&t.splice(0,1),t};var za=oa(["de","at"]);var Ba=[La("defaultValue",Pa("de",[1,1,9,1])),La("typeOf",Ma(ca("string"),"de",[1,1,9,2])),La("enum",Ma(za,"de",[1,1,9,3]))];var Ya=[La("defaultValue",Pa(!1,[1,1,10,1])),La("typeOf",ua(ca("boolean"),(()=>zt(4,1,1,10,2))))];var Qa=oa(["web","hyb","ctv"]);var Ha=[La("defaultValue",Pa("web",[1,1,1,11,1])),La("typeOf",Ma(ca("string"),"web",[1,1,11,2])),La("enum",Ma(Qa,"web",[1,1,11,3]))];var Ja=[La("required",ua(Kn,(()=>zt(4,1,1,12,1)))),La("typeof",ua(ca("string"),(()=>zt(4,1,1,12,2)))),La("regex",ua(Zn(/^(data-)([a-f0-9]{10})\.([a-zA-Z0-9][a-zA-Z0-9-_]{1,63})(?:\.([a-z]{2,63}))?\.([a-z]{2,63})$/g),(()=>zt(4,1,1,12,3))))];var Xa=oa(["inst","init","open","clse","play","resm","stop","fowa","bakw","recd","paus","forg","bakg","dele","refr","kill","view","alve","fini","mute","aforg","abakg","aclse","sple","scvl","serr","spyr","smdr","sfpl","sfqt","ssqt","stqt","soqt","sofc","scfc","scqt","splr","spli","sprs","spre","smrs","smre","sors","sore","sack","sapl","sapa","snsp"]);var Wa=[La("required",ua(Kn,(()=>zt(4,1,1,13,1)))),La("typeof",ua(ca("string"),(()=>zt(4,1,1,13,2)))),La("eventEnum",ua(Xa,(()=>zt(4,1,1,13,3))))];var Ka=[La("defaultValue",Pa(!0,[1,1,14,1])),La("typeOf",ua(ca("boolean"),(()=>zt(4,1,1,14,2))))];var Za=[La("required",ua(Kn,(()=>zt(4,1,1,23,1)))),La("typeOf",ua(ca("string"),(()=>zt(4,1,1,23,2))))];var ei=oa(["debug","hybrid"]);var ti=[La("required",ua(Kn,(()=>zt(4,1,1,19,1)))),La("typeof",ua(ca("string"),(()=>zt(4,1,1,19,2)))),La("enum",ua(ei,(()=>zt(4,1,1,19,2))))];var ri=[La("required",ua(Kn,(()=>zt(4,1,1,24,1)))),La("typeof",ua(ca("string"),(()=>zt(4,1,1,24,2))))];var ni=oa(["cp","sp","xp"]);var ai=[La("defaultValue",Pa("cp",[1,1,20,1])),La("typeOf",Ma(ca("string"),"cp",[1,1,20,2])),La("enum",Ma(ni,"cp",[1,1,20,3]))];var ii=[La("required",ua(Kn,(()=>zt(4,1,1,20,1)))),La("typeOf",ua(ca("string"),(()=>zt(4,1,1,20,2)))),La("alphanumeric",ua(ea,(()=>zt(4,1,1,20,3)))),La("min",ua(ia(3),(()=>zt(4,1,1,19,4)))),La("max",ua(aa(15),(()=>zt(4,1,1,19,5))))];var si=oa(["in","mo"]);var oi=[La("defaultValue",Pa("in",[1,1,21,1])),La("typeOf",Ma(ca("string"),"in",[1,1,21,2])),La("enum",Ma(si,"in",[1,1,21,3]))];var ci=[La("typeOf",ua(ca(sa),(()=>zt(4,1,1,22,1)))),La("between",ua(ra(1,4),(()=>zt(4,1,1,22,1))))];var ui=oa(xa);var li=[La("required",ua(Kn,(()=>zt(4,1,1,23,1)))),La("typeof",ua(ca("string"),(()=>zt(4,1,1,23,2)))),La("enum",ua(ui,(()=>zt(4,1,1,23,3))))];var di=[La("defaultValue",Pa(1,[1,1,17,1])),La("typeOf",Ma(ca("number"),1,[1,1,17,2])),La("max",Ma(ra(1,7),1,[1,1,17,3]))];var hi=[La("defaultValue",Pa(1,[1,1,18,1])),La("typeOf",Ma(ca("number"),1,[1,1,18,2])),La("max",Ma(ra(1,7),1,[1,1,18,3]))];var fi={id:1,name:"configure",abbreviation:"cf",parameters:[[Ra(ii),ha(ja),_a(Ja),va(Ya),Oa(Ka),Ca(ci),ga(Ha),ba(di),Ta(hi),Ea(Ba),pa($a(!1))]],options:{allowJSON:!0}};var mi={id:3,name:"event",abbreviation:"ev",dependencies:[1,2],parameters:[ya(Wa)],options:{allowJSON:!1}};var pi={id:4,name:"hybrid",abbreviation:"hy",parameters:[[Ea(Ba),va(Ya),_a(Ja),Ra(ii),Sa(Za)]],options:{allowJSON:!0}};var Ei=(e,...t)=>r=>e(r)?t:void 0;var vi=[fi,{id:2,name:"pageview",abbreviation:"pv",dependencies:[1],parameters:[[fa(Ga),ma(qa),Na(ai),Ca(ci)]],options:{allowJSON:!0}},pi,mi,{id:5,name:"setMode",abbreviation:"sm",parameters:[Aa(ti)],options:{allowJSON:!1}},{id:6,name:"setMultiIdentifier",abbreviation:"smi",parameters:[Ia(ri)],options:{allowJSON:!1}},{id:e=>xa.indexOf(e.thirdPartyModule)+7,name:"thirdPartyModules",abbreviation:"3p",dependencies:[1,2],parameters:[Da(li),Ei((e=>"qds"===e[0]),wa(oi))],options:{allowJSON:!1}}],gi="object"==typeof global&&global&&global.Object===Object&&global,_i="object"==typeof self&&self&&self.Object===Object&&self,yi=gi||_i||Function("return this")(),Oi=yi.Symbol,Si=Object.prototype,bi=Si.hasOwnProperty,Ti=Si.toString,Ai=Oi?Oi.toStringTag:void 0;var Ii=Object.prototype.toString;var Ni=Oi?Oi.toStringTag:void 0;function Ri(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ni&&Ni in Object(e)?function(e){var t=bi.call(e,Ai),r=e[Ai];try{e[Ai]=void 0;var n=!0}catch(e){}var a=Ti.call(e);return n&&(t?e[Ai]=r:delete e[Ai]),a}(e):function(e){return Ii.call(e)}(e)}function wi(e){return null!=e&&"object"==typeof e}function Ci(e){return"symbol"==typeof e||wi(e)&&"[object Symbol]"==Ri(e)}function Di(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var Mi=Array.isArray,Li=Oi?Oi.prototype:void 0,ji=Li?Li.toString:void 0;function Pi(e){if("string"==typeof e)return e;if(Mi(e))return Di(e,Pi)+"";if(Ci(e))return ji?ji.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}var Ui=/\s/;var Vi=/^\s+/;function Fi(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Ui.test(e.charAt(t)););return t}(e)+1).replace(Vi,""):e}function xi(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Gi=/^[-+]0x[0-9a-f]+$/i,qi=/^0b[01]+$/i,ki=/^0o[0-7]+$/i,$i=parseInt;var zi=1/0;function Bi(e){return e?(e=function(e){if("number"==typeof e)return e;if(Ci(e))return NaN;if(xi(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=xi(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Fi(e);var r=qi.test(e);return r||ki.test(e)?$i(e.slice(2),r?2:8):Gi.test(e)?NaN:+e}(e))===zi||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function Yi(e){var t=Bi(e),r=t%1;return t==t?r?t-r:t:0}function Qi(e){return e}function Hi(e){if(!xi(e))return!1;var t=Ri(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var Ji=yi["__core-js_shared__"],Xi=function(){var e=/[^.]+$/.exec(Ji&&Ji.keys&&Ji.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var Wi=Function.prototype.toString;var Ki=/^\[object .+?Constructor\]$/,Zi=Function.prototype,es=Object.prototype,ts=Zi.toString,rs=es.hasOwnProperty,ns=RegExp("^"+ts.call(rs).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function as(e){return!(!xi(e)||(t=e,Xi&&Xi in t))&&(Hi(e)?ns:Ki).test(function(e){if(null!=e){try{return Wi.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function is(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return as(r)?r:void 0}function ss(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var os=Date.now;var cs,us,ls,ds=function(){try{var e=is(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),hs=ds,fs=hs?function(e,t){return hs(e,"toString",{configurable:!0,enumerable:!1,value:(r=t,function(){return r}),writable:!0});var r}:Qi,ms=(cs=fs,us=0,ls=0,function(){var e=os(),t=16-(e-ls);if(ls=e,t>0){if(++us>=800)return arguments[0]}else us=0;return cs.apply(void 0,arguments)}),ps=ms;function Es(e){return e!=e}function vs(e,t){return!!(null==e?0:e.length)&&function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}(e,Es,r)}(e,t,0)>-1}var gs=Math.max;function _s(e,t){return ps(function(e,t,r){return t=gs(void 0===t?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=gs(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(s),ss(e,this,o)}}(e,t,Qi),e+"")}function ys(e){return wi(e)&&"[object Arguments]"==Ri(e)}var Os=Object.prototype,Ss=Os.hasOwnProperty,bs=Os.propertyIsEnumerable,Ts=ys(function(){return arguments}())?ys:function(e){return wi(e)&&Ss.call(e,"callee")&&!bs.call(e,"callee")},As=Ts;function Is(e){return function(t){return e(t)}}var Ns=is(Object,"create");var Rs=Object.prototype.hasOwnProperty;var ws=Object.prototype.hasOwnProperty;function Cs(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ds(e,t){for(var r,n,a=e.length;a--;)if((r=e[a][0])===(n=t)||r!=r&&n!=n)return a;return-1}Cs.prototype.clear=function(){this.__data__=Ns?Ns(null):{},this.size=0},Cs.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Cs.prototype.get=function(e){var t=this.__data__;if(Ns){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Rs.call(t,e)?t[e]:void 0},Cs.prototype.has=function(e){var t=this.__data__;return Ns?void 0!==t[e]:ws.call(t,e)},Cs.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ns&&void 0===t?"__lodash_hash_undefined__":t,this};var Ms=Array.prototype.splice;function Ls(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ls.prototype.clear=function(){this.__data__=[],this.size=0},Ls.prototype.delete=function(e){var t=this.__data__,r=Ds(t,e);return!(r<0)&&(r==t.length-1?t.pop():Ms.call(t,r,1),--this.size,!0)},Ls.prototype.get=function(e){var t=this.__data__,r=Ds(t,e);return r<0?void 0:t[r][1]},Ls.prototype.has=function(e){return Ds(this.__data__,e)>-1},Ls.prototype.set=function(e,t){var r=this.__data__,n=Ds(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var js=is(yi,"Map");function Ps(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Us(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Vs(e){return null==e?"":Pi(e)}function Fs(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}Us.prototype.clear=function(){this.size=0,this.__data__={hash:new Cs,map:new(js||Ls),string:new Cs}},Us.prototype.delete=function(e){var t=Ps(this,e).delete(e);return this.size-=t?1:0,t},Us.prototype.get=function(e){return Ps(this,e).get(e)},Us.prototype.has=function(e){return Ps(this,e).has(e)},Us.prototype.set=function(e,t){var r=Ps(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var xs=Oi?Oi.isConcatSpreadable:void 0;function Gs(e){return Mi(e)||As(e)||!!(xs&&e&&e[xs])}function qs(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=Gs),a||(a=[]);++i<s;){var o=e[i];t>0&&r(o)?t>1?qs(o,t-1,r,n,a):Fs(a,o):n||(a[a.length]=o)}return a}function ks(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:function(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(r=r>a?a:r)<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}(e,t,r)}var $s=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function zs(e){return $s.test(e)}var Bs="[\\ud800-\\udfff]",Ys="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Qs="\\ud83c[\\udffb-\\udfff]",Hs="[^\\ud800-\\udfff]",Js="(?:\\ud83c[\\udde6-\\uddff]){2}",Xs="[\\ud800-\\udbff][\\udc00-\\udfff]",Ws="(?:"+Ys+"|"+Qs+")"+"?",Ks="[\\ufe0e\\ufe0f]?",Zs=Ks+Ws+("(?:\\u200d(?:"+[Hs,Js,Xs].join("|")+")"+Ks+Ws+")*"),eo="(?:"+[Hs+Ys+"?",Ys,Js,Xs,Bs].join("|")+")",to=RegExp(Qs+"(?="+Qs+")|"+eo+Zs,"g");function ro(e){return zs(e)?function(e){return e.match(to)||[]}(e):function(e){return e.split("")}(e)}var no=is(yi,"Set");function ao(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Us;++t<r;)this.add(e[t])}function io(e,t){return e.has(t)}function so(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}function oo(e){return wi(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!Hi(e)}(e)}function co(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}ao.prototype.add=ao.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ao.prototype.has=function(e){return this.__data__.has(e)};var uo=Math.min;function lo(e){return oo(e)?e:[]}var ho=_s((function(e){var t=Di(e,lo);return t.length&&t[0]===e[0]?function(e,t,r){for(var n=r?co:vs,a=e[0].length,i=e.length,s=i,o=Array(i),c=1/0,u=[];s--;){var l=e[s];s&&t&&(l=Di(l,Is(t))),c=uo(l.length,c),o[s]=!r&&(t||a>=120&&l.length>=120)?new ao(s&&l):void 0}l=e[0];var d=-1,h=o[0];e:for(;++d<a&&u.length<c;){var f=l[d],m=t?t(f):f;if(f=r||0!==f?f:0,!(h?io(h,m):n(u,m,r))){for(s=i;--s;){var p=o[s];if(!(p?io(p,m):n(e[s],m,r)))continue e}h&&h.push(m),u.push(f)}}return u}(t):[]})),fo=ho,mo=Math.floor;function po(e,t){var r="";if(!e||t<1||t>9007199254740991)return r;do{t%2&&(r+=e),(t=mo(t/2))&&(e+=e)}while(t);return r}var Eo,vo=(Eo="length",function(e){return null==e?void 0:e[Eo]}),go="[\\ud800-\\udfff]",_o="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",yo="\\ud83c[\\udffb-\\udfff]",Oo="[^\\ud800-\\udfff]",So="(?:\\ud83c[\\udde6-\\uddff]){2}",bo="[\\ud800-\\udbff][\\udc00-\\udfff]",To="(?:"+_o+"|"+yo+")"+"?",Ao="[\\ufe0e\\ufe0f]?",Io=Ao+To+("(?:\\u200d(?:"+[Oo,So,bo].join("|")+")"+Ao+To+")*"),No="(?:"+[Oo+_o+"?",_o,So,bo,go].join("|")+")",Ro=RegExp(yo+"(?="+yo+")|"+No+Io,"g");function wo(e){return zs(e)?function(e){for(var t=Ro.lastIndex=0;Ro.test(e);)++t;return t}(e):vo(e)}var Co=Math.ceil;function Do(e,t){var r=(t=void 0===t?" ":Pi(t)).length;if(r<2)return r?po(t,e):t;var n=po(t,Co(e/wo(t)));return zs(t)?ks(ro(n),0,e).join(""):n.slice(0,e)}function Mo(e,t,r){e=Vs(e);var n=(t=Yi(t))?wo(e):0;return t&&n<t?Do(t-n,r)+e:e}var Lo=no&&1/so(new no([,-0]))[1]==1/0?function(e){return new no(e)}:function(){},jo=Lo;var Po=_s((function(e){return function(e,t,r){var n=-1,a=vs,i=e.length,s=!0,o=[],c=o;if(r)s=!1,a=co;else if(i>=200){var u=t?null:jo(e);if(u)return so(u);s=!1,a=io,c=new ao}else c=t?[]:o;e:for(;++n<i;){var l=e[n],d=t?t(l):l;if(l=r||0!==l?l:0,s&&d==d){for(var h=c.length;h--;)if(c[h]===d)continue e;t&&c.push(d),o.push(l)}else a(c,d,r)||(c!==o&&c.push(d),o.push(l))}return o}(qs(e,1,oo,!0))})),Uo=Po;const Vo=e=>e.core?Uo(Object.keys(e.core.purpose.consents).filter((t=>!0===e.core.purpose.consents[t])).map((e=>+e)),Object.keys(e.core.purpose.legitimateInterests).filter((t=>!0===e.core.purpose.legitimateInterests[t])).map((e=>+e))).concat(Object.keys(e.core.specialFeatureOptins).filter((t=>!0===e.core.specialFeatureOptins[t])).map((e=>+e+10))):Uo(Object.keys(e.purpose.consents).filter((t=>!0===e.purpose.consents[t])).map((e=>+e)),Object.keys(e.purpose.legitimateInterests).filter((t=>!0===e.purpose.legitimateInterests[t])).map((e=>+e))).concat(Object.keys(e.specialFeatureOptins).filter((t=>!0===e.specialFeatureOptins[t])).map((e=>+e+10)));var Fo=(e,t)=>{const r=((e,t)=>e.core?fo(Uo(Object.keys(e.core.vendorConsents).filter((t=>!0===e.core.vendorConsents[t])).map((e=>+e)),Object.keys(e.core.vendorLegitimateInterests).filter((t=>!0===e.core.vendorLegitimateInterests[t])).map((e=>+e))),t):fo(Uo(Object.keys(e.vendor.consents).filter((t=>!0===e.vendor.consents[t])).map((e=>+e)),Object.keys(e.vendor.legitimateInterests).filter((t=>!0===e.vendor.legitimateInterests[t])).map((e=>+e))),t))(e,t),n=[];for(let a=0,i=t.length;a<i;a+=1){let i=[];const s=t[a];r.includes(s)&&(i=Vo(e)),n.push(i)}return n};const xo=e=>e.map((e=>2**(e-1))).reduce(((e,t)=>e+t),0);class Go{constructor(e,t,r){Object.defineProperties(this,{type:{value:e,writable:!1,enumerable:!0,configurable:!1},value:{value:t,writeable:!1,enumerable:!0,configurable:!1},vendors:{value:r,writeable:!1,enumerable:!0,configurable:!1}})}check(e,t){const r=this.vendors.indexOf(e),n=Array.isArray(t)?t:[t];if(r>-1){let e=xo(n);if(r<this.vendors.length-1){let t=e.toString(16);t=function(e,t,r){e=Vs(e);var n=(t=Yi(t))?wo(e):0;return t&&n<t?e+Do(t-n,r):e}(t,4*(this.vendors.length-r)-(4-t.length),"0"),e=parseInt(t,16)}return(this.value&e)===e}return!1}toString(e=16){return 2===e?`${Mo(this.type.toString(2),8,"0")}${Mo(this.value.toString(2),16*this.vendors.length,"0")}`:`${Mo(this.type.toString(e),2,"0")}${Mo(this.value.toString(e),4*this.vendors.length,"0")}`}static create(e,t,r=Go.TYPES.TCF2X){let n="";for(let r=0,a=e.length;r<a;r+=1){n+=Mo(xo(t[r]).toString(16),4,"0")}return n=parseInt(n,16),new Go(r,n,e)}}Go.TYPES=Object.defineProperties({},{NONE:{value:0,writeable:!1,enumerable:!0,configurable:!1},TCF2X:{value:1,writeable:!1,enumerable:!0,configurable:!1},CUSTOM:{value:255,writeable:!1,enumerable:!0,configurable:!1}});var qo=Go;class ko extends k{constructor(e){super(),this.vendors=e,this.ioConsentString=void 0}convert(e){try{if(e){const t=Fo(e,this.vendors);return this.ioConsentString=qo.create(this.vendors,t),this.emit(ko.EVENTS.TCF_CONVERT_SUCCESS,{ioConsentString:this.ioConsentString}),this.ioConsentString}throw new Ft(Ft.TYPES.ERROR,3,3,2,1)}catch(e){const t=new Ft(Ft.TYPES.ERROR,3,3,2,2,e instanceof Ft?e:e.message);return void this.emit(ko.EVENTS.TCF_CONVERT_FAILED,t)}}}var $o=ko;ko.EVENTS={TCF_CONVERT_SUCCESS:"TCF_CONVERT_SUCCESS",TCF_CONVERT_FAILED:"TCF_CONVERT_FAILED"};const zo=e=>{const{category:t,validated:r}=e;if(!r){if(!t||!Object.values(Bo.CATEGORIES).includes(t))throw new Ft(4,1,3,1,1);e.validated=!0}};class Bo extends k{constructor(){super(),this.moduleId=3,this.data=void 0}setItem(e,t,r){try{zo(r);const{category:n}=r;void 0===this.data&&(this.data={global:{},measurement:{},sensor:{},feature:{},plugins:{},thirdPartyPlugins:{},tcf:{}}),this.data[n][e]=t,this.emit(Bo.generateDataMutationEventName(Bo.MUTATION_EVENTS.SET,n,e),{key:e,value:t,category:n})}catch(e){throw new Ft(4,1,this.moduleId,2,1,e instanceof Ft?e:e.message)}}setItems(e,t,r){zo(r);for(let n=0,a=e.length;n<a;n+=1)this.setItem(e[n],t[n],r)}deleteItem(e,t){try{if(zo(t),this.data){const{category:r}=t;delete this.data[r][e],this.emit(Bo.generateDataMutationEventName(Bo.MUTATION_EVENTS.DELETE,r,e),{key:e,category:r})}}catch(e){throw new Ft(4,1,this.moduleId,4,1,e.message)}}deleteItems(e,t){zo(t);for(let r=0,n=e.length;r<n;r+=1)this.deleteItem(e[r],t)}getItem(e,t){try{zo(t);const{category:r}=t,n={key:e,category:r,value:void 0};return this.data&&this.data[r]&&void 0!==this.data[r][e]&&(n.value=this.data[r][e]),n}catch(e){throw new Ft(4,1,this.moduleId,6,1,e.message)}}getItems(e,t){zo(t);const r=[];for(let n=0,a=e.length;n<a;n+=1)r.push(this.getItem(e[n],t));return r}static generateDataMutationEventName(e,t,r){return`data.mutation.${`${e}.${t}.${r}`.toLowerCase()}`}}Bo.CATEGORIES={GLOBAL:"global",MEASUREMENT:"measurement",SENSOR:"sensor",FEATURE:"feature",PLUGINS:"plugins",THIRD_PARTY_PLUGINS:"thirdPartyPlugins",TCF:"tcf",BUNDLE_ACTIVE:"bundleActive"},Bo.MUTATION_EVENTS={SET:"SET",DELETE:"DELETE"};const Yo=(e,t)=>{if(t.tcf){const{value:r}=e.manager.dataLayer.getItem("consentString",{category:"tcf"});r instanceof qo&&t.queue.queue.items.forEach(((e,n)=>{"configure"===e[0]&&(e[1].consentString=r.toString(16),t.queue.queue.items[n]=e)}))}},Qo=(e,t,r)=>{if(t.tcf){const{value:t}=e.manager.dataLayer.getItem("consentString",{category:"tcf"});t instanceof qo&&(r.consentString=t.toString(16))}return r};class Ho extends k{constructor(e,t){super(),this.moduleId=2,this.manager=e,this.defaultModules=t.map((e=>e.name)),this.modules=new Map(t.map((e=>[e.name,{...e,queue:new qt(void 0,{mode:qt.MODE.MANUAL}),active:!1,tcf:!!e.tcf}]))),this.manager.dataLayer.on(Bo.generateDataMutationEventName(Bo.MUTATION_EVENTS.SET,Bo.CATEGORIES.TCF,"consentString"),(()=>{this.handleConsentChanged()}))}addModule(e,t){if(this.modules.has(e)){const e=new Ft(3,1,this.moduleId,3,1);this.emit(Ho.EVENTS.ADD_MODULE,e)}else this.modules.set(e,{...t,queue:new qt(void 0,{mode:qt.MODE.MANUAL}),active:!1})}addFacade(e,t){const r=this.modules.get(e);r.queue.addFacadeFactory(t),this.modules.set(e,r)}removeFacade(e){const t=this.modules.get(e);t.queue.removeFacadeFactory(),this.modules.set(e,t)}activate(e){const t=this.modules.get(e);Yo(this,t),t.active=!0,t.queue.options.mode=qt.MODE.AUTO,t.queue.dequeue(),this.modules.set(e,t)}deactivate(e){const t=this.modules.get(e);t.active=!1,t.queue.options.mode=qt.MODE.MANUAL,t.queue.flush(),this.modules.set(e,t)}enqueue(e,t={}){try{this.modules.forEach(((r,n)=>{if(-1===this.defaultModules.indexOf(n))return;let i=a(t);"configure"===e&&(i=Qo(this,r,i)),r.queue.enqueue(e,i)}))}catch(e){const t=new Ft(3,1,this.moduleId,1,1,e);throw this.emit(Ho.EVENTS.ENQUEUE_ERROR,t),t}}enqueueToSingleModule(e,t,r={}){try{const n=this.modules.get(e);if(n){let e=a(r);"configure"===t&&(e=Qo(this,n,e)),n.queue.enqueue(t,e)}}catch(e){const t=new Ft(3,1,this.moduleId,4,1,e);throw this.emit(Ho.EVENTS.ENQUEUE_ERROR,t),t}}dequeue(){try{this.modules.forEach(((e,t)=>{-1!==this.defaultModules.indexOf(t)&&e.queue.dequeue()}))}catch(e){const t=new Ft(3,1,this.moduleId,2,1,e);throw this.emit(Ho.EVENTS.ENQUEUE_ERROR,t),t}}handleConsentChanged(){try{this.modules.forEach((e=>{Yo(this,e)}))}catch(e){const t=new Ft(Ft.TYPES.ERROR,3,this.moduleId,5,2,e.message);this.emit(Ho.EVENTS.EXECUTION_ERROR,t)}}}Ho.EVENTS={MODULE_NOT_LOADED:"MODULE_NOT_LOADED",QUEUE_CREATION_ERROR:"QUEUE_CREATION_ERROR",QUEUE_DOES_NOT_EXIST:"QUEUE_DOES_NOT_EXIST",ENQUEUE_ERROR:"ENQUEUE_ERROR",DEQUEUE_ERROR:"DEQUEUE_ERROR",ADD_MODULE:"ADD_MODULE",EXECUTION_ERROR:"EXECUTION_ERROR"};const Jo=1,Xo=2,Wo=3;var Ko={sensors:{iomb:{bit:1,cdn:{id:0,path:({ecmaVersion:e,variant:t,version:r})=>`/iomb/${r}/sensor/manager/${t}/${e}/bundle.js`}},ioma:{bit:2,tcf:{consent:[1,8],vendor:730},cdn:{id:0,path:({ecmaVersion:e,variant:t,version:r,cryptoSupport:n})=>`/ioma/${r}/sensor/manager/${t}/${e}/${n}/bundle.js`}},iomp:{bit:4,tcf:{consent:[1,8],vendor:730},cdn:{id:1,path:({ecmaVersion:e,variant:t,version:r})=>`/sensor/${r}/manager/${t}/${e}/bundle.js`}}},modules:{qds:{cdn:{id:1,path:({ecmaVersion:e,version:t})=>`/3p/qds/${t}/manager/base/${e}/bundle.js`},tcf:{consent:[1,9],vendor:785}}},tcf:{vendors:[730,785],frequency:100,max:10,wait:5e3,events:["tcloaded","useractioncomplete"]},cdn:["dsn","script.ioam.de"],hybrid:{performSiteCheck:!1,apiKeys:{ios:"IOMbHybridMessageHandler",android:"IOMbHybridBridge"}},metaTags:{loading:"iomm_config_loading"}};const Zo=1,ec=2,tc=3,rc=e=>Ko.sensors[e]?{name:e,...Ko.sensors[e]}:Ko.modules[e]?{name:e,...Ko.modules[e]}:null;var nc=(e=Zo)=>{const t=[];return e!==Zo&&e!==ec||Object.keys(Ko.sensors).forEach((e=>{t.push({name:e,...Ko.sensors[e]})})),e!==Zo&&e!==tc||Object.keys(Ko.modules).forEach((e=>{t.push({name:e,...Ko.modules[e]})})),t};const ac={iomb:"IOMb",ioma:"IOMa",iomp:"IOMp",qds:"IOMp3pQds"};class ic extends k{constructor(e,t,r=Ko){if(super(),this.moduleId=4,void 0===e)throw new Ft(4,1,this.moduleId,1,1);this.dataLayer=e,this.manager=t,this.settings=r}load(t,r,n=!1){return new Promise(((a,i)=>{try{const s={category:Bo.CATEGORIES.SENSOR},o=this.dataLayer.getItem(r,s);if(o&&void 0===o.value){const o={url:t},{value:c="async"}=this.dataLayer.getItem("loading",{category:Bo.CATEGORIES.GLOBAL});o[c]=c,r===ic.BUNDLE_VARIANTS.IOMB&&(o.crossOrigin="anonymous"),e(o).then((()=>{const e=ac[r],t=window[e];t?(n||delete window[e],this.dataLayer.setItem(r,"function"==typeof t?t:()=>t,s),a()):i(new Ft(3,1,this.moduleId,2,2))})).catch((e=>{i(new Ft(3,1,this.moduleId,2,1,e.message))}))}else a()}catch(e){i(new Ft(3,1,this.moduleId,2,3,e.message))}}))}generateSensorUrl(e){const t=rc(e.sensorVariant);if(void 0===e.cdn||void 0===e.sensorVariant||void 0===t)throw new Ft(3,1,this.moduleId,3,1);let r="base";e.sensorVariant!==ic.BUNDLE_VARIANTS.IOMB&&e.sensorVariant!==ic.BUNDLE_VARIANTS.IOMP||!function(e,t,r=Jo){const{value:a}=e.dataLayer.getItem("hybrid",{category:"global"}),i=n(t),s=Object.keys(t),o=e.commandProcessor.history.has(6)||e.commandProcessor.commandQueue.queue.items.findIndex((([e])=>"smi"===e||"setMultiIdentifier"===e))>-1;return r===Xo?!0===a&&s.includes(i):r===Wo?!0===a&&o:!0===a&&(s.includes(i)||o)}(this.manager,this.settings.hybrid.apiKeys,Xo)||(r="hybrid");const a={ecmaVersion:window[window.IOMmGlobalObject].esm?"es6":"es5",variant:r,version:"latest",cryptoSupport:window.crypto&&window.crypto.subtle?"native":"legacy"},i=t.cdn.path;return`//${e.cdn}${i(a)}`}generateModuleUrl(e){const t=rc(e.moduleVariant);if(void 0===e.cdn||void 0===e.moduleVariant||void 0===t)throw new Ft(3,1,this.moduleId,4,1);const r={ecmaVersion:window[window.IOMmGlobalObject].esm?"es6":"es5",version:"latest"},n=t.cdn.path;return`//${e.cdn}${n(r)}`}}ic.BUNDLE_VARIANTS={IOMB:"iomb",IOMA:"ioma",IOMP:"iomp",QDS:"qds"},ic.LOADING_METHODS={ASYNC:"async",DEFER:"defer"};const sc=e=>{window.__tcfapi("removeEventListener",2,(()=>{}),e)},oc=(e,t)=>{e&&e.listenerId>=0&&(t.stopPolling?sc(e.listenerId):t.tcfApiListenerIds.push(e.listenerId))},cc=e=>(t,r)=>{try{if(oc(t,e),e.stopPolling)return;let n;r&&e.settings.tcf.events.includes(t.eventStatus)&&!0===t.gdprApplies?(n=e.convert(t),e.emit(lc.EVENTS.TCF_DATA_PROCESSED),window.__tcfapi("removeEventListener",2,(()=>{}),t.listenerId)):(n=qo.create(e.vendors,[[0],[0]],qo.TYPES.TCF2X),e.emit(lc.EVENTS.TCF_DATA_CANNOT_BE_PROCESSED)),e.dataLayer.setItem("consentString",n,{category:Bo.CATEGORIES.TCF})}catch(t){const r=new Ft(Ft.TYPES.ERROR,3,6,1,1,t.message);e.emit(lc.EVENTS.TCF_DATA_PROCESSING_ERROR,r)}},uc=e=>{e.stopPolling||(window.__tcfapi&&"function"==typeof window.__tcfapi?(window.__tcfapi("addEventListener",2,cc(e)),window.__tcfapi("addEventListener",2,(e=>(t,r)=>{oc(t,e),e.stopPolling||r&&"cmpuishown"===t.eventStatus&&window.__tcfapi("addEventListener",2,cc(e))})(e))):(e.numberOfTries<e.settings.tcf.max+1?setTimeout((()=>{uc(e)}),e.numberOfTries<e.settings.tcf.max?e.settings.tcf.frequency:e.settings.tcf.wait):e.emit(lc.EVENTS.TCF_API_NOT_ACCESSIBLE),e.numberOfTries+=1))};class lc extends $o{constructor(e,t,r=Ko){super(e),this.moduleId=6,this.vendors=e,this.dataLayer=t,this.numberOfTries=0,this.stopPolling=!1,this.tcfApiListenerIds=[],this.settings=r}process(){try{uc(this)}catch(e){const t=new Ft(Ft.TYPES.ERROR,3,this.moduleId,5,1,e.message);throw this.emit(lc.EVENTS.TCF_DATA_PROCESSING_ERROR,t),t}}stop(){try{this.tcfApiListenerIds.forEach((e=>{sc(e)})),this.stopPolling=!0}catch(e){const t=new Ft(Ft.TYPES.ERROR,3,this.moduleId,6,1,e.message);throw this.emit(lc.EVENTS.TCF_API_CANNOT_STOP,t),t}}}lc.EVENTS={TCF_DATA_PROCESSED:"TCF_DATA_PROCESSED",TCF_DATA_CANNOT_BE_PROCESSED:"TCF_DATA_CANNOT_BE_PROCESSED",TCF_API_NOT_ACCESSIBLE:"TCF_API_NOT_ACCESSIBLE",TCF_DATA_PROCESSING_ERROR:"TC_DATA_PROCESSING_ERROR",TCF_API_CANNOT_STOP:"TCF_API_CANNOT_STOP"};var dc=e=>{try{e.handledBfCache||(window.addEventListener("pageshow",(t=>{if(!0===t.persisted){const t=e.dataLayer.getItems(["code","comment","pixelType"],{category:"measurement"}).reduce(((e,{key:t,value:r})=>(e[t]=r,e)),{});setTimeout((()=>{e.command("pageview",t)}),0)}})),e.handledBfCache=!0)}catch(t){e.emit("EXECUTION_ERROR",t)}};var hc=(e,t)=>{try{const r=new qo(qo.TYPES.NONE,parseInt(e.substring(2),16),t.settings.tcf.vendors);if(r.toString(16)!==`00${e.substring(2)}`){throw new Ft(Ft.TYPES.ERROR,3,1,3,1)}return t.tcfProcessor.stop(),r}catch(e){return t.emit("MANUAL_CONSENT_ERROR",e),null}};var fc=e=>{try{document.querySelectorAll("meta").forEach((t=>{if(t.getAttribute("name")===e.settings.metaTags.loading){const r=t.getAttribute("content");r!==ic.LOADING_METHODS.ASYNC&&r!==ic.LOADING_METHODS.DEFER||e.dataLayer.setItem("loading",r,{category:Bo.CATEGORIES.GLOBAL})}}))}catch(t){const r=new Ft(Ft.TYPES.ERROR,3,1,4,1,t.message);e.emit("EXECUTION_ERROR",r)}};const mc=(e,t)=>{try{const{value:r}=t.dataLayer.getItem("methods",{category:Bo.CATEGORIES.GLOBAL});e.filter((e=>void 0===e.bit||(r&e.bit)===e.bit)).forEach((e=>{let r=!e.tcf;const n=t.dataLayer.getItem(e.name,{category:Bo.CATEGORIES.SENSOR});if(e.tcf){const{value:a}=t.dataLayer.getItem("consentString",{category:Bo.CATEGORIES.TCF});a&&a instanceof qo?(r=a.check(e.tcf.vendor,e.tcf.consent),r?(n.value||t.commandDispatcher.activate(e.name),t.dataLayer.on(Bo.generateDataMutationEventName(Bo.MUTATION_EVENTS.SET,Bo.CATEGORIES.TCF,"consentString"),(()=>{pc([e],t)}))):t.dataLayer.once(Bo.generateDataMutationEventName(Bo.MUTATION_EVENTS.SET,Bo.CATEGORIES.TCF,"consentString"),(()=>{mc([e],t)}))):t.dataLayer.once(Bo.generateDataMutationEventName(Bo.MUTATION_EVENTS.SET,Bo.CATEGORIES.TCF,"consentString"),(()=>{mc([e],t)}),e.name)}else t.commandDispatcher.activate(e.name);if(n.value)t.commandDispatcher.addFacade(e.name,n.value);else if(r){let r;t.dataLayer.once(Bo.generateDataMutationEventName(Bo.MUTATION_EVENTS.SET,Bo.CATEGORIES.SENSOR,e.name),(()=>{mc([e],t)}));const n=0===e.cdn.id?t.dataLayer.getItem("domainServiceName",{category:Bo.CATEGORIES.GLOBAL}).value:t.settings.cdn[e.cdn.id];r=Object.keys(t.settings.sensors).includes(e.name)?t.bundleLoader.generateSensorUrl({cdn:n,static:e.cdn.static,sensorVariant:e.name}):t.bundleLoader.generateModuleUrl({cdn:n,moduleVariant:e.name}),t.bundleLoader.load(r,e.name,e.cdn.static).catch((e=>{t.emit("EXECUTION_ERROR",e)}))}}))}catch(e){t.emit("EXECUTION_ERROR",e)}},pc=(e,t)=>{try{e.filter((e=>{const{value:r}=t.dataLayer.getItem("methods",{category:Bo.CATEGORIES.GLOBAL});return void 0===e.bit||(r&e.bit)===e.bit})).forEach((e=>{const{value:r}=t.dataLayer.getItem("consentString",{category:Bo.CATEGORIES.TCF});if(r&&r instanceof qo){if(!1===r.check(e.tcf.vendor,e.tcf.consent))t.commandDispatcher.removeFacade(e.name),t.commandDispatcher.deactivate(e.name);else{const r=t.dataLayer.getItem(e.name,{category:Bo.CATEGORIES.SENSOR});r&&r.value?(t.commandDispatcher.addFacade(e.name,r.value),t.commandDispatcher.activate(e.name)):mc([e],t)}}}))}catch(e){t.emit("EXECUTION_ERROR",e)}};class Ec extends k{constructor(e,t=Ko){super(),this.moduleId=1,this.commandQueue=e,this.commandProcessor=new da(e,vi,{fillParameters:!0,maxExecutionBeforeStop:3}),this.dataLayer=new Bo,this.commandDispatcher=new Ho(this,nc(ec)),this.settings=t,this.bundleLoader=new ic(this.dataLayer,this,this.settings),this.tcfProcessor=new lc(this.settings.tcf.vendors,this.dataLayer,this.settings),this.skipExecution=!1,this.handledBfCache=!1,this.tcfProcessor.process(),fc(this)}command(e,...t){try{this.commandProcessor.commandSerializer.reset();const r=this.commandProcessor.process(e,...t);if(r&&r.parameters){switch(e){case Ec.COMMANDS.CONFIGURE:if(r.parameters.consentString){const e=hc(r.parameters.consentString,this);e&&e instanceof qo&&(r.parameters.consentString=e.toString(16),this.dataLayer.setItem("consentString",e,{category:Bo.CATEGORIES.TCF})),null===e&&delete r.parameters.consentString}this.dataLayer.setItems(Object.keys(r.parameters),Object.values(r.parameters),{category:Bo.CATEGORIES.GLOBAL}),mc(nc(ec),this);break;case Ec.COMMANDS.PAGEVIEW:this.dataLayer.deleteItem("event",{category:Bo.CATEGORIES.MEASUREMENT}),this.dataLayer.setItems(Object.keys(r.parameters),Object.values(r.parameters),{category:Bo.CATEGORIES.MEASUREMENT}),dc(this);break;case Ec.COMMANDS.THIRD_PARTY_MODULES:rc(r.parameters.thirdPartyModule)&&((e,t)=>{try{const r=rc(e.thirdPartyModule),{surveyType:n}=e;t.commandDispatcher.addModule(r.name,r);const[{value:a},{value:i}]=t.dataLayer.getItems(["site","country"],{category:Bo.CATEGORIES.GLOBAL}),[{value:s},{value:o}]=t.dataLayer.getItems(["code","pixelType"],{category:Bo.CATEGORIES.MEASUREMENT}),c={st:a,cn:i,cp:s,pt:o,sv:n};t.commandDispatcher.enqueueToSingleModule(r.name,"configure",c),mc([r],t)}catch(e){t.emit(Ec.EVENTS.EXECUTION_ERROR,e)}})(r.parameters,this),this.skipExecution=!0;break;case Ec.COMMANDS.EVENT:this.dataLayer.setItem("event",r.parameters.event,{category:Bo.CATEGORIES.MEASUREMENT});break;case Ec.COMMANDS.SET_MULTI_IDENTIFIER:this.dataLayer.setItem("multiIdentifier",r.parameters.multiIdentifier,{category:Bo.CATEGORIES.GLOBAL}),this.commandDispatcher.enqueueToSingleModule(ic.BUNDLE_VARIANTS.IOMP,Ec.COMMANDS.SET_MULTI_IDENTIFIER,r.parameters.multiIdentifier),this.skipExecution=!0}return!1===this.skipExecution&&this.commandDispatcher.enqueue(e,r.parameters),void(this.skipExecution=!1)}throw new Ft(Ft.TYPES.FATAL,3,1,1,1,this.commandProcessor.commandSerializer.lastAssertion)}catch(e){throw e instanceof Ft?e:new Ft(Ft.TYPES.FATAL,3,1,1,2,e.message)}}}function vc(e){const t=new Ec(e);return{cf(...e){t.command(Ec.COMMANDS.CONFIGURE,...e)},configure(...e){t.command(Ec.COMMANDS.CONFIGURE,...e)},pv(...e){t.command(Ec.COMMANDS.PAGEVIEW,...e)},pageview(...e){t.command(Ec.COMMANDS.PAGEVIEW,...e)},sm(...e){t.command(Ec.COMMANDS.SET_MODE,...e)},setMode(...e){t.command(Ec.COMMANDS.SET_MODE,...e)},"3p"(...e){t.command(Ec.COMMANDS.THIRD_PARTY_MODULES,...e)},thirdPartyModules(...e){t.command(Ec.COMMANDS.THIRD_PARTY_MODULES,...e)},event(...e){t.command(Ec.COMMANDS.EVENT,...e)},ev(...e){t.command(Ec.COMMANDS.EVENT,...e)},hybrid(...e){t.command(Ec.COMMANDS.HYBRID,...e)},hy(...e){t.command(Ec.COMMANDS.HYBRID,...e)},smi(...e){t.command(Ec.COMMANDS.SET_MULTI_IDENTIFIER,...e)},setMultiIdentifier(...e){t.command(Ec.COMMANDS.SET_MULTI_IDENTIFIER,...e)}}}Ec.COMMANDS={CONFIGURE:"configure",PAGEVIEW:"pageview",HYBRID:"hybrid",EVENT:"event",SET_MODE:"setMode",THIRD_PARTY_MODULES:"thirdPartyModules",SET_MULTI_IDENTIFIER:"setMultiIdentifier"},Ec.MODULES={QDS:"qds"},Ec.EVENTS={COMMAND_DOES_NOT_EXIST:"COMMAND_DOES_NOT_EXIST",EXECUTION_ERROR:"EXECUTION_ERROR",MANUAL_CONSENT_ERROR:"MANUAL_CONSENT_ERROR"};const gc="IOMmGlobalObject"in window?window.IOMmGlobalObject:window.IOMmGlobalObject="IOMm",_c=window[gc]||(window[gc]=(...e)=>{(window[gc].q=window[gc].q||[]).push(...e)});window.iom||(window.iom={},window.iom.smi=window.iom.setMultiIdentifier=e=>_c("setMultiIdentifier",e)),_c.q=new qt(vc,{multiTenancy:!0},_c.q),_c.create=vc}();
